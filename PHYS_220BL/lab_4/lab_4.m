R_ep=[0.666,0.357,0.77,3.36,6.62,8.2];
R_th=[0.6651,0.3381,0.7663,3.3609,6.6467,8.2374];
p=polyfit(R_th,R_ep,1);
f=p(1)*R_th+p(2);
r=R_ep./R_th;
n=length(r);
slope=sum(r)/n;
uncertainty=sqrt(sum(abs(r-slope).^2)/(n-1));
hold off;
h=figure(1);
plot(R_th,R_ep,'sr',R_th,f,'-b','Linewidth',1.5);
fontSize=18;
set(gca,'fontSize',fontSize);
title('R_{pexp} vs. R_{pth}');
xlabel('Theoretical');
ylabel('Experiment');
xlim([R_th(1)-0.5,R_th(6)+0.5]);
ylim([R_ep(1)-0.5,R_ep(6)+0.5]);
txt=['R_p = ' num2str(round(slope,2)) ' \pm ' num2str(round(uncertainty,2)) ' \Omega'];
text(1.5,6,txt,'FontSize',14);
exportgraphics(h,'lab4.jpeg');